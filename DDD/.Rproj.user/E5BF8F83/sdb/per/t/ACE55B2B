{
    "collab_server" : "",
    "contents" : "\\name{dd_LR}\n\\alias{dd_LR}\n\\title{Bootstrap likelihood ratio test of diversity-dependent diversification model\n}\n\\description{\n   This function computes the maximum likelihood and the associated estimates of\n   the parameters of a diversity-dependent diversification model for a given set\n   of phylogenetic branching times. It then performs a bootstrap likelihood ratio\n   test of the diversity-dependent (DD) model against the constant-rates (CR)\n   birth-death model. Finally, it computes the power of this test.\n}\n\\usage{\ndd_LR(\n   brts,\n   initparsoptDD,\n   initparsoptCR,\n   missnumspec,\n   outputfilename = NULL,\n   seed = 42,\n   endmc = 1000,\n   alpha = 0.05,\n   plotit = TRUE,\n   res = 10 * (1 + length(brts) + missnumspec),\n   ddmodel = 1,\n   cond = 1,\n   btorph = 1,\n   soc = 2,\n   tol = c(1E-3,1E-4,1E-6),\n   maxiter = 2000,\n   changeloglikifnoconv = FALSE,\n   optimmethod = 'subplex',\n   methode = 'analytical'    \n   )\n}\n\\arguments{\n  \\item{brts}{A set of branching times of a phylogeny, all positive }\n  \\item{initparsoptDD}{The initial values of the parameters that must be optimized for the diversity-dependent (DD) model: lambda_0, mu and K}\n  \\item{initparsoptCR}{The initial values of the parameters that must be optimized for the constant-rates (CR) model: lambda and mu}\n  \\item{missnumspec}{The number of species that are in the clade but missing in the phylogeny } \n  \\item{outputfilename}{The name (and location) of the file where the output will be saved. Default is no save.}\n  \\item{seed}{The seed for the pseudo random number generator for simulating the bootstrap data}\n  \\item{endmc}{The number of bootstraps}\n  \\item{alpha}{The significance level of the test}  \n  \\item{plotit}{Boolean to plot results or not}    \n  \\item{res}{ Sets the maximum number of species for which a probability must be computed, must be larger than 1 + length(brts) }\n  \\item{ddmodel}{ Sets the model of diversity-dependence: \\cr\n   \\code{ddmodel == 1} : linear dependence in speciation rate with parameter K (= diversity where speciation = extinction)\\cr\n   \\code{ddmodel == 1.3} : linear dependence in speciation rate with parameter K' (= diversity where speciation = 0)\\cr\n   \\code{ddmodel == 2} : exponential dependence in speciation rate with parameter K (= diversity where speciation = extinction)\\cr\n   \\code{ddmodel == 2.1} : variant of exponential dependence in speciation rate with offset at infinity\\cr\n   \\code{ddmodel == 2.2} : 1/n dependence in speciation rate\\cr\n   \\code{ddmodel == 2.3} : exponential dependence in speciation rate with parameter x (= exponent)\\cr\n   \\code{ddmodel == 3} : linear dependence in extinction rate \\cr\n   \\code{ddmodel == 4} : exponential dependence in extinction rate \\cr\n   \\code{ddmodel == 4.1} : variant of exponential dependence in extinction rate with offset at infinity \\cr\n   \\code{ddmodel == 4.2} : 1/n dependence in extinction rate with offset at infinity \\cr\n   \\code{ddmodel == 5} : linear dependence in speciation and extinction rate \\cr\n  }\n  \\item{cond}{ Conditioning: \\cr\n    cond == 0 : conditioning on stem or crown age \\cr\n    cond == 1 : conditioning on stem or crown age and non-extinction of the phylogeny \\cr\n    cond == 2 : conditioning on stem or crown age and on the total number of extant taxa (including missing species) \\cr\n    cond == 3 : conditioning on the total number of extant taxa (including missing species) \\cr\n   Note: cond == 3 assumes a uniform prior on stem age, as is the standard in constant-rate birth-death models, see\ne.g. D. Aldous & L. Popovic 2004. Adv. Appl. Prob. 37: 1094-1115 and T. Stadler 2009. J. Theor. Biol. 261: 58-66.\nThis conditioning turns out, for the diversity-dependent model, \nto provide the least-biased parameter estimates when extinction is low, but may still contain considerable bias if extinction is high.\nThe default value has therefore been changed from 1 to 3 starting with DDD version 2.2.\n  }\n  \\item{btorph}{Sets whether the likelihood is for the branching times (0) or the phylogeny (1)}\n  \\item{soc}{Sets whether stem or crown age should be used (1 or 2) }\n  \\item{tol}{Sets the tolerances in the optimization. Consists of: \\cr\n   reltolx = relative tolerance of parameter values in optimization \\cr\n   reltolf = relative tolerance of function value in optimization \\cr\n   abstolx = absolute tolerance of parameter values in optimization\n  }\n  \\item{maxiter}{Sets the maximum number of iterations in the optimization}\n  \\item{changeloglikifnoconv}{ if TRUE the loglik will be set to -Inf if ML does not converge}\n  \\item{optimmethod}{ Method used in optimization of the likelihood. Current default is 'subplex'. Alternative is 'simplex' (default of previous versions)}\n  \\item{methode}{The method used to solve the master equation, default is 'analytical' which uses matrix exponentiation; alternatively numerical ODE solvers can be used, such as 'lsoda' or 'ode45'. These were used in the package before version 3.1. }         \n}\n\\details{\nThe output is a list with 3 elements:\n}\n\\value{\n \\item{treeCR}{a list of trees generated under the constant-rates model using the ML parameters under the CR model}\n \\item{treeDD}{a list of trees generated under the diversity-dependent model using the ML parameters under the diversity-dependent model}\n \\item{out}{a dataframe with the parameter estimates and maximum likelihoods for diversity-dependent and constant-rates models\n    \\code{$model} - the model used to generate the data. 0 = unknown (for real data), 1 = CR, 2 = DD \\cr\n    \\code{$mc} - the simulation number for each model \\cr    \n    \\code{$lambda_CR} - speciation rate estimated under CR \\cr        \n    \\code{$mu_CR} - extinction rate estimated under CR \\cr            \n    \\code{$LL_CR} - maximum likelihood estimated under CR \\cr            \n    \\code{$conv_CR} - convergence code for likelihood optimization; conv = 0 means convergence \\cr            \n    \\code{$lambda_DD1} - initial speciation rate estimated under DD for first set of initial values\\cr        \n    \\code{$mu_DD1} - extinction rate estimated under DD for first set of initial values \\cr            \n    \\code{$K_DD1} - clade-wide carrying-capacity estimated under DD for first set of initial values \\cr                \n    \\code{$LL_DD1} - maximum likelihood estimated under DD for first set of initial values \\cr            \n    \\code{$conv_DD1} - convergence code for likelihood optimization for first set of initial values; conv = 0 means convergence \\cr            \n    \\code{$lambda_DD2} - initial speciation rate estimated under DD for second set of initial values\\cr        \n    \\code{$mu_DD2} - extinction rate estimated under DD for second set of initial values \\cr            \n    \\code{$K_DD2} - clade-wide carrying-capacity estimated under DD for second set of initial values \\cr                \n    \\code{$LL_DD2} - maximum likelihood estimated under DD for second set of initial values \\cr            \n    \\code{$conv_DD2} - convergence code for likelihood optimization for second set of initial values; conv = 0 means convergence \\cr    \n    \\code{$LR} - likelihood ratio between DD and CR        \n }\n \\item{pvalue}{p-value of the test}\n \\item{LRalpha}{Likelihood ratio at the signifiance level alpha}\n \\item{poweroftest}{power of the test for significance level alpha} \n}\n\\references{\n- Etienne, R.S. et al. 2016. Meth. Ecol. Evol. 7: 1092-1099, doi: 10.1111/2041-210X.12565 \\cr \n- Etienne, R.S. et al. 2012, Proc. Roy. Soc. B 279: 1300-1309, doi: 10.1098/rspb.2011.1439 \\cr\n- Etienne, R.S. & B. Haegeman 2012. Am. Nat. 180: E75-E89, doi: 10.1086/667574\n}\n\\author{ Rampal S. Etienne & Bart Haegeman }\n\n\\seealso{\n \\code{\\link{dd_loglik}},\n \\code{\\link{dd_ML}}\n}\n\\keyword{ models }\n",
    "created" : 1478516899262.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2741778657",
    "id" : "ACE55B2B",
    "lastKnownWriteTime" : 1478517019,
    "last_content_update" : 1478517019234,
    "path" : "D:/data/Ms/DDD/DDD/man/dd_LR.Rd",
    "project_path" : "man/dd_LR.Rd",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_doc"
}