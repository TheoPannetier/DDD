library("DDD", lib.loc="C:/Program Files/R/R-devel/library")
library(DDD)
library(DDD)
library(DDD)
d_ML(brts = c(brtsM,brtsS), cond = 3,methode = 'lsoda')
dd_ML(brts = c(brtsM,brtsS), cond = 3,methode = 'analytical')
dd_ML(brts = c(brtsM,brtsS), cond = 3,methode = 'lsoda');
dd_ML(brts = c(brtsM,brtsS), cond = 3,methode = 'analytical')
phy<-dd_sim(pars=c(0.5,0.001,15),age=20,ddmodel = 1)$tes
brts<-branching.times(phy)
brts<-brts+abs(min(brts))
brts
sort(brts)
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
source('d:/data/ms/DDD/tests/testDDD_Alex.R')
source('d:/data/ms/DDD/tests/testDDD_Alex.R')
?dd_ML
dd_ML
dd_ML(brts)
brts
dd_ML(as.numeric(brts)
)
dd_ML(1:10)
dd_ML(brts)
dd_ML(brts)
dd_ML(brts,methode = 'lsoda')
dd_ML(brts,methode = 'ode45')
dd_ML(brts,methode = 'lsodes')
dd_ML(brts,methode = 'analytical')
as.logical(3)
as.logical(1.2)
as.logical(0.2)
as.logical(0)
dd_ML(brts,methode = 'analytical',cond - 1)
dd_ML(brts,methode = 'analytical',cond = 1)
dd_loglik
dd_loglik2
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
dd_ML(brts,methode = 'analytical',cond = 3)
library(DDD)
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
library(DDD)
dd_ML(brts,methode = 'analytical',cond = 3)
0.41/(0.41-0.275)*5.27
probs = rep(0,lx + 1)
library(DDD)
probs = rep(0,lx + 1)
dd_ML(brts,methode = 'analytical',cond = 3)
0.54/(0.54-0.27)*28
0.5483/(0.5483-0.275)*28
dd_loglik_M_bw_aux(pars1 = c(0.5483871,0.2753623,28.0000000), lx = 58,k1 = 15, ddep = 1, tt = 1)
dd_loglik_M_bw_aux(pars1 = c(0.5483871,0.2753623,28.0000000), lx = 58,k1 = 15, ddep = 1)
dd_loglik_M_bw_aux(pars = c(0.5483871,0.2753623,28.0000000), lx = 58,k1 = 15, ddep = 1)
dd_loglik_M_bw_aux(pars = c(0.5483871,0.2753623,28.0000000), lx = 58,k = 15, ddep = 1)
dd_loglik_M_bw(pars = c(0.5483871,0.2753623,28.0000000), lx = 58,k = 15, ddep = 1,tt = 1)
dd_loglik_M_bw(pars = c(0.5483871,0.2753623,28.0000000), lx = 58,k = 15, ddep = 1,tt = 1,p = c(1,rep(0,57)))
dd_loglik_M_bw(pars = c(0.5483871,0.2753623,28.0000000), lx = 58,k = 15, ddep = 1,tt = 1,p = c(1,rep(0,57)))[1:10]
brts
sort(brts)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
library(DDD)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
library(DDD)
library(DDD)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
source('d:/data/ms/DDD/R/dd_loglik_M_bw.R')
source('d:/data/ms/DDD/R/dd_loglik_M.R')
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
library(DDD)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
library(DDD)
dd_ML(as.numeric(brts),methode = 'analytical',cond = 3)
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3))
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'lsoda')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
source('d:/data/ms/DDD/tests/testDDD_Alex')
source('d:/data/ms/DDD/tests/testDDD_Alex.R')
brts
load('d:/data/ms/testData2.rda')
brts
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'ode45')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'lsodes')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'ode32')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'rk4')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'ode23')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,15), idparsopt = c(1,2,3),idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = 0, cond = 3, btorph = 1,soc = 2, tol = c(1E-3, 1E-4, 1E-6), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
succession_lam
<-function(lam_back,mu_shared,Kshared,lam_lat,transition){
model<-dd_MS_ML(back_bts, lat_bts,tsplit=divergence,initparsopt=c(lam_back,mu_shared,Kshared,lam_lat,transition),idparsopt=c(1,2,3,4,6),idparsnoshift=c(5),ddmodel=1.3,cond=0,missnumspec=c(10, 1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
return(model)}
succession_lam(10,1,0.5,150,5,1)
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
succession_lam
<-function(lam_back,mu_shared,Kshared,lam_lat,transition){
model<-dd_MS_ML(back_bts, lat_bts,tsplit=divergence,initparsopt=c(lam_back,mu_shared,Kshared,lam_lat,transition),idparsopt=c(1,2,3,4,6),idparsnoshift=c(5),ddmodel=1.3,cond=0,missnumspec=c(10, 1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
return(model)}
succession_lam(10,1,0.5,150,5,1)
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
succession_lam
<-function(lam_back,mu_shared,Kshared,lam_lat,transition){
model<-dd_MS_ML(back_bts, lat_bts,tsplit=divergence,initparsopt=c(lam_back,mu_shared,Kshared,lam_lat,transition),idparsopt=c(1,2,3,4,6),idparsnoshift=c(5),ddmodel=1.3,cond=0,missnumspec=c(10, 1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
return(model)}
succession_lam(10,1,0.5,150,5,1)
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
succession_lam
<-function(lam_back,mu_shared,Kshared,lam_lat,transition){
model<-dd_MS_ML(back_bts, lat_bts,tsplit=divergence,initparsopt=c(lam_back,mu_shared,Kshared,lam_lat,transition),idparsopt=c(1,2,3,4,6),idparsnoshift=c(5),ddmodel=1.3,cond=0,missnumspec=c(10, 1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
return(model)}
succession_lam<-function(lam_back,mu_shared,Kshared,lam_lat,transition){
model<-dd_MS_ML(back_bts, lat_bts,tsplit=divergence,initparsopt=c(lam_back,mu_shared,Kshared,lam_lat,transition),idparsopt=c(1,2,3,4,6),idparsnoshift=c(5),ddmodel=1.3,cond=0,missnumspec=c(10, 1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
return(model)}
succession_lam(10,1,0.5,150,5,1)
load("C://Analysis to date/DDD/testData.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
#Using analytical we get the following error
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,25), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = missnumspec, cond = 2, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'analytical')
succession_lam(10,1,0.5,150,5,1)load("C://Analysis to date/DDD/testData.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
#Using analytical we get the following error
load("C://Analysis to date/DDD/testData.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
#Using analytical we get the following error
load("d:/data/ms/DDD/tests/testData.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
#Using analytical we get the following error
load("d:/data/ms/DDD/tests/testData_Alex2.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
load("d:/data/ms/DDD/tests/testDDD_Alex2.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
load("d:/data/ms/testData.rda")
##############################################################################################################
#with conditionings 0-2 the old and new method give identical results
##############################################################################################################
missnumspec = 10
idparsopt = c(1,2,3)
brts
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,25), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = missnumspec, cond = 3, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'ode45')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,25), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = missnumspec, cond = 3, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'lsodes')
mod<-dd_ML(brts, initparsopt = c(0.5,0.001,25), idparsopt = c(1,2,3),
idparsfix = c(), parsfix = c(), res = 10*(1+length(brts)+missnumspec), ddmodel = 1, missnumspec = missnumspec, cond = 3, btorph = 1,
soc = 2, tol = c(1E-3, 1E-4, 1E-6), maxiter = 1000 * round((1.25)^length(idparsopt)), changeloglikifnoconv = FALSE, optimmethod = 'subplex', methode = 'lsoda')
dd_ML(1:10,cond = 3,methode = 'analytical')
dd_ML(1:10,cond = 3,methode = 'lsoda')
dd_ML(1:10,cond = 3,methode = 'lsoda')
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
write.table(c("shared_uncoupling","maxcred",paste(missing_nonlats_maxmin),model[1:7],model$loglik,model$df,model$conv),"~/Dropbox/Zosterops_reloaded/DD_analytical.txt",sep="\t",col.names=F,row.names=F,append=TRUE)
}
uncoupling_shared(1,0.5,150,1)
divergence = L.S.,
Bijgevoegd de stukken van de VvE Het Eiland (Sumatralaan 21)
Met vriendelijke groet,
Rampal Etienne
divergence= 2.649345
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
write.table(c("shared_uncoupling","maxcred",paste(missing_nonlats_maxmin),model[1:7],model$loglik,model$df,model$conv),"~/Dropbox/Zosterops_reloaded/DD_analytical.txt",sep="\t",col.names=F,row.names=F,append=TRUE)
}
uncoupling_shared(1,0.5,150,1)
uncoupling_shared(1.001,0.5,150,1)
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
uncoupling_shared(1.0000001,0.5,150,1)
library(DDD)
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
divergence= 2.649345
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
brts
back_bts
uncoupling_shared(1.0000001,0.5,150,1)
uncoupling_shared(1,0.5,150,1)
uncoupling_shared(1+1E-6,0.5,150,1)
uncoupling_shared(1+1E-12,0.5,150,1)
dd_loglik_M
library(DDD)
dd_loglik_M
install.packages("D:/data/Ms/DDD_3.1.zip", repos = NULL, type = "win.binary")
detach.package(DDD)
detach(DDD)
detach(package:DDD)
install.packages("D:/data/Ms/DDD_3.1.zip", repos = NULL, type = "win.binary")
library(DDD)
uncoupling_shared(1+1E-12,0.5,150,1)
uncoupling_shared(1,0.5,150,1)
dd_loglik_M
install.packages("D:/data/Ms/DDD_3.1.zip", repos = NULL, type = "win.binary")
library(DDD)
dd_loglik_M
rm(list = ls())
library(DDD)
dd_loglik_M
uncoupling_shared(1,0.5,150,1)
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
divergence = 2.649345
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
uncoupling_shared(1,0.5,150,1)
dd_loglik_M2
source('d:/data/ms/DDD/R/dd_loglik_M')
source('d:/data/ms/DDD/R/dd_loglik_M.R')
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
divergence = 2.649345
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
uncoupling_shared(1,0.5,150,1)
rm(list = ls())
library(DDD)
dd_loglik_M
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
divergence = 2.649345
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
uncoupling_shared(1,0.5,150,1)
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
divergence = 2.649345
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
uncoupling_shared(1+1E-12,0.5,150,1)
library(DDD)
dd_loglik_M
library(DDD)
dd_loglik_M
back_bts<-c(0.1877250,0.2087868,0.3413979,0.4520262,0.7163060,0.7643441,0.9541403,0.9545586,1.1112803,1.1737123,1.2569488,1.3437365,1.3933051,1.4129568,1.4766956,1.7494716,1.7728837,1.8479813,1.8685767,2.1482443,2.1642694,2.4426107,2.4518384,2.5205936,2.5532803,2.6493445,2.7778104,2.8317066,2.9282082,2.9494312,3.0543736,3.1230989,3.3094204)
lat_bts<-c(0.73559774,0.49237817,0.34770316,0.29873582,0.25527416,0.23030902,0.20144252,0.16335605,0.14014265,0.10186753,0.08035629)
divergence = 2.649345
uncoupling_shared<-function(lam_shared,mu_shared,Kshared,transition){
model<-dd_KI_ML(back_bts, lat_bts, divergence,initparsopt=c(lam_shared,mu_shared,Kshared,transition),idparsopt=c(1,2,3,7),idparsnoshift=c(4,5,6),ddmodel=1.3,cond=0,missnumspec=c(10,1),maxiter=1000,optimmethod = 'subplex',methode='analytical')
}
uncoupling_shared(1+1E-12,0.5,150,1)
library(DDD)
